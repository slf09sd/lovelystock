<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LovelyStock ‚Äî Liquid Glass UI</title>
  <style>
    :root{
      --bg:#fff; --muted:#6b7280; --accent:#ef476f;
      --gap:12px; --radius:14px;
      --shadow:0 6px 18px rgba(2,6,23,0.08);
    }
    *{box-sizing:border-box;margin:0;padding:0;}
    html,body{height:100%;background:rgba(255,255,255,0.15);backdrop-filter:blur(24px) saturate(220%);font-family:Inter,sans-serif;overflow-x:hidden;}

    /* ===== Header ===== */
    header{
      display:flex;align-items:center;justify-content:space-between;
      padding:1rem 2rem;margin:1rem auto;
      max-width:900px;border-radius:2rem;
      background:rgba(255,255,255,0.15);
      backdrop-filter:blur(28px) saturate(220%);
      box-shadow:0 12px 40px rgba(0,0,0,0.15);position:relative;overflow:hidden;
    }
    .logo{font-weight:700;font-size:1.5rem;color:var(--accent);cursor:pointer;z-index:10;}
    .search-bar{display:flex;gap:8px;align-items:center;flex:1;margin-left:1rem;z-index:10;}
    .search-bar input{flex:1;padding:.6rem 1rem;border-radius:999px;border:1px solid rgba(255,255,255,0.3);background:rgba(255,255,255,0.25);backdrop-filter:blur(16px);color:#111;}
    .search-bar button{padding:.5rem .8rem;border-radius:999px;background:var(--accent);border:none;color:white;cursor:pointer;}

    /* ===== Animated particles ===== */
    header::before{content:'';position:absolute;inset:0;background:radial-gradient(circle,#ffffff20,#ffffff00 70%);opacity:0.3;animation:particles 12s linear infinite;z-index:5;}
    @keyframes particles{0%{transform:translate(0,0);}50%{transform:translate(30px,20px);}100%{transform:translate(0,0);}}

    main{padding:1rem;max-width:1400px;margin:0 auto;}

    /* ===== Image Grid ===== */
    #imageGallery{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:var(--gap);width:100%;}
    .image-card{position:relative;border-radius:var(--radius);overflow:hidden;
      background:rgba(255,255,255,0.18);backdrop-filter:blur(16px) saturate(200%);
      box-shadow:0 6px 24px rgba(0,0,0,0.12);cursor:pointer;
      transition:transform 0.28s ease, box-shadow 0.28s ease;
    }
    .image-card img{width:100%;height:100%;object-fit:cover;display:block;transition:transform 0.5s ease;}
    .image-card:hover img{transform:scale(1.05) rotate(0.5deg);}
    /* Ripple hover effect */
    .image-card::after{content:'';position:absolute;inset:0;border-radius:inherit;background:radial-gradient(circle,rgba(255,255,255,0.15) 10%,transparent 70%);opacity:0;pointer-events:none;transition:opacity 0.5s,transform 0.5s;}
    .image-card:hover::after{opacity:1;transform:scale(1.5);}

    /* ===== Popup ===== */
    .popup{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,0.5);z-index:200;}
    .popup.open{display:flex;}
    .popup-content{display:flex;flex-direction:row;gap:1rem;
      backdrop-filter:blur(36px) saturate(250%);
      background:rgba(255,255,255,0.12);
      border-radius:2rem;
      box-shadow:0 12px 40px rgba(0,0,0,0.25);
      padding:2rem;
      transform:scale(0.8);
      animation:popupIn 0.4s cubic-bezier(.2,.9,.2,1) forwards;
    }
    @keyframes popupIn{0%{opacity:0;transform:scale(0.8) rotate(-2deg);}50%{transform:scale(1.05) rotate(1deg);}100%{opacity:1;transform:scale(1) rotate(0);}}

    .popup-media{flex:1;min-width:220px;border-radius:1.5rem;overflow:hidden;}
    .popup-media img{width:100%;height:100%;object-fit:contain;}
    .popup-side{width:320px;display:flex;flex-direction:column;gap:.5rem;}
    .popup-title{font-weight:700;font-size:1.2rem;margin:0;color:#111;}
    .popup-desc{color:var(--muted);font-size:.9rem;overflow:auto;max-height:300px;}
    .download-button{padding:.6rem 1rem;border-radius:1rem;background:var(--accent);color:#fff;text-decoration:none;font-weight:600;text-align:center;}
    .close-btn{background:transparent;border:none;color:var(--muted);font-size:1.2rem;cursor:pointer;align-self:flex-end;}

    @media (max-width:640px){
      .popup-content{flex-direction:column;max-height:92vh;overflow:auto;padding:1rem;}
      .popup-side{width:100%;}
      #imageGallery{grid-template-columns:repeat(auto-fit,minmax(140px,1fr));}
    }
  </style>
</head>
<body>
  <header>
    <div class="logo" id="logo">LovelyStock</div>
    <div class="search-bar">
      <input id="searchBox" type="text" placeholder="Search images (press Enter)">
      <button id="searchBtn">üîç</button>
    </div>
  </header>

  <main>
    <div id="imageGallery"></div>
    <div id="pagination"></div>
  </main>

  <div id="imagePopup" class="popup">
    <div class="popup-content">
      <div class="popup-media">
        <img id="popupImage" src="" alt="">
      </div>
      <div class="popup-side">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <h3 id="popupTitle" class="popup-title">Title</h3>
          <button id="closePopupBtn" class="close-btn">‚úï</button>
        </div>
        <div id="popupDesc" class="popup-desc">Description</div>
        <a id="popupDownload" class="download-button" href="#" download>Download</a>
      </div>
    </div>
  </div>

  <footer style="text-align:center;padding:20px;color:var(--muted);font-size:13px">¬© 2024 LovelyStock</footer>

  <script>
    let images=[]; let currentPage=1; const imagesPerPage=100; let currentImageList=[];
    const CSV_URL='https://slf09sd.github.io/lovelystock/images.csv';
    const fallbackDataURI='data:image/svg+xml;utf8,'+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="800" height="600"><rect width="100%" height="100%" fill="#f3f4f6"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="#9ca3af" font-size="20">Image not available</text></svg>');

    async function loadCSV(){try{const r=await fetch(CSV_URL,{cache:'no-cache'});if(!r.ok)throw new Error('CSV fetch failed:'+r.status);const t=await r.text();if(!t||!t.trim())throw new Error('CSV empty');images=parseCSV(t);showRandomImages();}catch(err){console.error(err);document.getElementById('imageGallery').innerHTML='<div class="error-message">Failed to load images.</div>';}}
    function parseCSV(d){const lines=d.split('\n').map(l=>l.trim()).filter(l=>l);const res=[];for(let i=1;i<lines.length;i++){const c=smartSplit(lines[i]);if(c.length>=1){const url=c[0].trim(),title=c.slice(1).join(',').trim()||'';if(url&&(/https?:\/\//.test(url)))res.push({url,title});}}return res;}
    function smartSplit(r){const i=[];let c='',q=false;for(let j=0;j<r.length;j++){const ch=r[j];if(ch=='"'){q=!q;continue;}if(ch==','&&!q){i.push(c);c='';}else{c+=ch;}}i.push(c);return i.map(s=>s.trim());}
    function showRandomImages(){currentImageList=[...images].sort(()=>Math.random()-0.5).slice(0,imagesPerPage);currentPage=1;showImages(currentImageList);}
    function searchImages(){const q=document.getElementById('searchBox').value.trim().toLowerCase();if(!q){showRandomImages();return;}currentImageList=images.filter(img=>(img.title||'').toLowerCase().includes(q)).slice(0,imagesPerPage);currentPage=1;showImages(currentImageList);}
    function showImages(list){const g=document.getElementById('imageGallery');const p=document.getElementById('pagination');g.innerHTML='';if(list.length===0){g.innerHTML='<div class="error-message">No images found.</div>';p.innerHTML='';return;}const start=(currentPage-1)*imagesPerPage;const pageImages=list.slice(start,start+imagesPerPage);pageImages.forEach((imgObj,idx)=>{const card=document.createElement('div');card.className='image-card';const img=document.createElement('img');img.loading='lazy';img.decoding='async';img.src=imgObj.url;img.alt=imgObj.title||'LovelyStock image';img.dataset.url=imgObj.url;img.dataset.title=imgObj.title||'';img.addEventListener('error',()=>{img.src=fallbackDataURI;});img.addEventListener('click',()=>openPopup(img.dataset.url,img.dataset.title));img.addEventListener('keydown',e=>{if(e.key==='Enter')openPopup(img.dataset.url,img.dataset.title);});img.tabIndex=0;card.appendChild(img);g.appendChild(card);});updatePagination(list);document.documentElement.scrollTo({top:0,behavior:'smooth'});}
    function updatePagination(list){const p=document.getElementById('pagination');const total=Math.ceil(list.length/imagesPerPage)||1;p.innerHTML=`<div class="pagination-info">Page ${currentPage} of ${total}</div><div style="display:flex;gap:8px"><button class="page-button" id="prevBtn">&lt; Back</button><button class="page-button" id="nextBtn">Forward &gt;</button></div>`;document.getElementById('prevBtn').disabled=(currentPage===1);document.getElementById('nextBtn').disabled=(currentPage===total);document.getElementById('prevBtn').onclick=()=>{if(currentPage>1){currentPage--;showImages(currentImageList);}};document.getElementById('nextBtn').onclick=()=>{if(currentPage<total){currentPage++;showImages(currentImageList);}};}

    const popup=document.getElementById('imagePopup');const popupImage=document.getElementById('popupImage');const popupTitle=document.getElementById('popupTitle');const popupDesc=document.getElementById('popupDesc');const popupDownload=document.getElementById('popupDownload');const closePopupBtn=document.getElementById('closePopupBtn');
    function openPopup(url,title){popupImage.src=url;popupImage.alt=title||'Image';popupTitle.textContent=title||'Untitled';popupDesc.textContent=title||'No description';popupDownload.href=url;popupDownload.download=(title||url.split('/').pop());popup.classList.add('open');document.body.style.overflow='hidden';}
    function closePopup(){popup.classList.remove('open');popupImage.src='';document.body.style.overflow='auto';}
    popup.addEventListener('click',e=>{if(e.target===popup)closePopup();});closePopupBtn.addEventListener('click',closePopup);
    document.getElementById('searchBox').addEventListener('keypress',e=>{if(e.key==='Enter')searchImages();});
    document.getElementById('searchBtn').addEventListener('click',searchImages);
    document.getElementById('logo').addEventListener('click',()=>{document.getElementById('searchBox').value='';showRandomImages();});
    window.addEventListener('load',loadCSV);
  </script>
</body>
</html>
